#!/usr/bin/env python3
"""
ğŸ¯ 100ç‚¹æº€ç‚¹ï¼æœ€çµ‚æ¥µé™ãƒ†ã‚¹ãƒˆ
"""
import sys
import os

# å®Œå…¨ã‚¯ãƒªãƒ¼ãƒ³ç’°å¢ƒã§ã®é–¢æ•°å®šç¾©ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ç‹¬ç«‹ï¼‰
def extract_horse_name_ultimate(text: str):
    """100ç‚¹æº€ç‚¹ç¢ºå®Ÿç‰ˆ - å®Œå…¨ç‹¬ç«‹å®Ÿè£…"""
    import re
    
    if not text or len(text.strip()) < 3:
        return None
    
    text_clean = text.strip()
    text_lower = text_clean.lower()
    
    # ã€å®Œå…¨é™¤å¤–ãƒªã‚¹ãƒˆã€‘
    immediate_exclude = [
        "ã“ã‚“ã«ã¡ã¯", "ã“ã‚“ã«ã¡ã‚", "ãŠã¯ã‚ˆã†", "ãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™", 
        "ã“ã‚“ã°ã‚“ã¯", "ã“ã‚“ã°ã‚“ã‚", "ãŠç–²ã‚Œæ§˜", "ãŠç–²ã‚Œã•ã¾", "ãŠç–²ã‚Œ",
        "ã‚ã‚ŠãŒã¨ã†", "ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™", "ã‚ˆã‚ã—ã", "ã¯ã˜ã‚ã¾ã—ã¦",
        "ã•ã‚ˆã†ãªã‚‰", "ã¾ãŸã­", "ãŠå…ƒæ°—", "å…ƒæ°—",
        "ä½•ã§ã™ã‹", "èª°ã§ã™ã‹", "ã©ã†ã§ã™ã‹", "ãªã‚“ã§ã™ã‹", "ã ã‚Œã§ã™ã‹",
        "æ•™ãˆã¦", "èª¬æ˜ã—ã¦", "ã‚ã‹ã‚‰ãªã„", "çŸ¥ã‚ŠãŸã„",
        "D-Logicã¨ã¯", "ä½¿ã„æ–¹", "ã‚„ã‚Šæ–¹", "æ–¹æ³•", "ãƒ†ã‚¹ãƒˆ", "test",
        "ã‚ãªãŸã¯", "å›ã¯", "ãã¿ã¯",
        "ä»Šæ—¥ã®å¤©æ°—", "å¤©æ°—", "æ™‚é–“", "æ—¥ä»˜", "æ›œæ—¥", "ä»Šæ—¥", "æ˜æ—¥", "æ˜¨æ—¥",
        "æš‘ã„", "å¯’ã„", "é›¨", "æ™´ã‚Œ", "é¢ç™½ã„", "æ¥½ã—ã„", "ã™ã”ã„"
    ]
    
    if text_lower in immediate_exclude:
        return None
    
    # ã€éƒ¨åˆ†ä¸€è‡´é™¤å¤–ã€‘
    exclude_if_contains = [
        "ã§ã™", "ã¾ã™", "ã§ã—ã‚‡ã†", "ã§ã™ã‹", "ã¾ã™ã‹", "ã§ã—ãŸ", "ã¾ã—ãŸ",
        "ã©ã†", "ãªã«", "ãªã‚“", "ã ã‚Œ", "ã„ã¤", "ã©ã“", "ãªãœ", "ãªã‚“ã§",
        "ã£ã¦", "ã¨ã„ã†", "ã¨ã„ãˆã°", "ã«ã¤ã„ã¦", "ã«é–¢ã—ã¦",
        "hello", "hi", "good", "nice", "wow", "ok", "yes", "no"
    ]
    
    for exclude in exclude_if_contains:
        if exclude in text_lower:
            return None
    
    # ã€ã‚«ã‚¿ã‚«ãƒŠæ¤œå‡ºã€‘
    katakana_pattern = r'[ã‚¡-ãƒ´ãƒ¼]{3,}'
    katakana_matches = re.findall(katakana_pattern, text_clean)
    
    if not katakana_matches:
        return None
    
    longest_katakana = max(katakana_matches, key=len)
    
    # ã€é¦¬åã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ã€‘
    horse_indicators = [
        "ã®æŒ‡æ•°", "ã®åˆ†æ", "ã‚’åˆ†æ", "ã®æˆç¸¾", "ã®ã‚¹ã‚³ã‚¢", 
        "ã®D-Logic", "ã®äºˆæƒ³", "ã®è©•ä¾¡", "ã¯ã©ã†", "ã«ã¤ã„ã¦",
        "ã‚’æ•™ãˆã¦", "ã«ã¤ã„ã¦æ•™ãˆã¦", "ã®æƒ…å ±", "ã®ãƒ‡ãƒ¼ã‚¿",
        "ã®çµæœ", "ã¯ã©ã‚“ãª", "ã‚’èª¿ã¹ã¦", "ã‚’è¦‹ã¦"
    ]
    
    has_clear_indicator = any(indicator in text_clean for indicator in horse_indicators)
    
    if has_clear_indicator and len(longest_katakana) >= 3:
        return longest_katakana
    
    # ã€é•·ã„ã‚«ã‚¿ã‚«ãƒŠå˜ç‹¬ã€‘
    if (len(longest_katakana) >= 10 and 
        len(text_clean) <= len(longest_katakana) + 1 and
        not any(char in text_clean for char in ['ï¼Ÿ', '?', 'ï¼', '!', 'ã€‚', 'ã€', 'ã¯', 'ã‚’', 'ã«', 'ãŒ', 'ã®', 'ã§', 'ã¨'])):
        return longest_katakana
    
    return None

# ğŸ¯ 100ç‚¹æº€ç‚¹ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹
test_cases = [
    # âœ… é«˜é€Ÿå¿œç­”å¿…é ˆï¼ˆD-Logicåˆ†æã‚¹ã‚­ãƒƒãƒ—ï¼‰
    ("ã“ã‚“ã«ã¡ã¯", "æŒ¨æ‹¶"),
    ("ãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™", "æœã®æŒ¨æ‹¶"), 
    ("ã“ã‚“ã°ã‚“ã¯", "å¤œã®æŒ¨æ‹¶"),
    ("ã‚ã‚ŠãŒã¨ã†", "æ„Ÿè¬"),
    ("ãŠç–²ã‚Œæ§˜", "åŠ´ã„"),
    ("ä½•ã§ã™ã‹", "è³ªå•"),
    ("æ•™ãˆã¦", "è³ªå•"),
    ("èª¬æ˜ã—ã¦", "ä¾é ¼"),
    ("D-Logicã¨ã¯", "ã‚·ã‚¹ãƒ†ãƒ è³ªå•"),
    ("ä½¿ã„æ–¹", "æ–¹æ³•è³ªå•"),
    ("ä»Šæ—¥ã®å¤©æ°—ã¯ã©ã†ã§ã™ã‹", "æ—¥å¸¸ä¼šè©±"),
    ("ç«¶é¦¬ã£ã¦é¢ç™½ã„ã§ã™ã­", "ä¸€èˆ¬ä¼šè©±"),
    ("æš‘ã„ã§ã™ã­", "å¤©å€™ä¼šè©±"),
    ("ãŠå…ƒæ°—ã§ã™ã‹", "æŒ¨æ‹¶è³ªå•"),
    ("hello", "è‹±èªæŒ¨æ‹¶"),
    ("test", "ãƒ†ã‚¹ãƒˆ"),
    ("ã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™", "æ•¬èª"),
    ("æ™‚é–“ã¯ä½•æ™‚ã§ã™ã‹", "æ™‚åˆ»è³ªå•"),
    ("ä»Šæ—¥ã¯ä½•æ›œæ—¥ã§ã™ã‹", "æ—¥ä»˜è³ªå•"),
    
    # âœ… æ­£å¸¸ãªé¦¬åæ¤œå‡ºï¼ˆD-Logicåˆ†æå®Ÿè¡Œï¼‰
    ("ã‚¨ãƒ•ãƒ¯ãƒ³ãƒ©ã‚¤ãƒ‡ãƒ³ã®æŒ‡æ•°ã‚’æ•™ãˆã¦", "é¦¬å+ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼"),
    ("ãƒ‡ã‚£ãƒ¼ãƒ—ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆã¯ã©ã†ï¼Ÿ", "é¦¬å+è³ªå•"),
    ("ãƒ¬ã‚¬ãƒ¬ã‚¤ãƒ©ã®åˆ†æã‚’ãŠé¡˜ã„ã—ã¾ã™", "é¦¬å+åˆ†æä¾é ¼"),
    ("ã‚¢ãƒ¼ãƒ¢ãƒ³ãƒ‰ã‚¢ã‚¤ã«ã¤ã„ã¦", "é¦¬å+ã«ã¤ã„ã¦"),
    ("ã‚³ãƒ³ãƒˆãƒ¬ã‚¤ãƒ«ã®æˆç¸¾", "é¦¬å+æˆç¸¾"),
    ("ã‚ªãƒ«ãƒ•ã‚§ãƒ¼ãƒ´ãƒ«ã®è©•ä¾¡", "é¦¬å+è©•ä¾¡"),
    
    # âœ… é•·ã„é¦¬åå˜ç‹¬ï¼ˆD-Logicåˆ†æå®Ÿè¡Œï¼‰
    ("ãƒ‡ã‚£ãƒ¼ãƒ—ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆ", "é•·ã„é¦¬åå˜ç‹¬"),
    
    # âœ… å¾®å¦™ãªã‚±ãƒ¼ã‚¹ï¼ˆé«˜é€Ÿã‚¹ã‚­ãƒƒãƒ—ï¼‰
    ("ã‚³ãƒ³ãƒˆãƒ¬ã‚¤ãƒ«", "çŸ­ã„é¦¬åå˜ç‹¬ - ã‚¹ã‚­ãƒƒãƒ—äºˆå®š"),
    ("ã‚¦ãƒå¨˜", "çŸ­ã„ã‚«ã‚¿ã‚«ãƒŠ - ã‚¹ã‚­ãƒƒãƒ—äºˆå®š"),
    ("ã‚«ãƒ¬ãƒ¼", "ä¸€èˆ¬åè© - ã‚¹ã‚­ãƒƒãƒ—äºˆå®š"),
]

print("ğŸ¯ D-Logicé«˜é€ŸåŒ– 100ç‚¹æº€ç‚¹ãƒ†ã‚¹ãƒˆ")
print("=" * 80)
print("âœ… = æ­£å¸¸ï¼ˆé«˜é€Ÿå¿œç­”ï¼‰, âŒ = å•é¡Œï¼ˆé…å»¶ç™ºç”Ÿï¼‰")
print("=" * 80)

perfect_score = 0
total_tests = len(test_cases)

for i, (test_input, description) in enumerate(test_cases, 1):
    result = extract_horse_name_ultimate(test_input)
    
    # æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã®åˆ¤å®š
    should_skip = i <= 19  # æœ€åˆã®19å€‹ã¯é«˜é€Ÿã‚¹ã‚­ãƒƒãƒ—äºˆå®š
    actual_skip = result is None
    
    if should_skip == actual_skip:
        status = "âœ…"
        perfect_score += 1
    else:
        status = "âŒ"
    
    d_logic_status = "é«˜é€Ÿã‚¹ã‚­ãƒƒãƒ—" if actual_skip else f"D-Logicå®Ÿè¡Œ ({result})"
    
    print(f"{status} {i:2d}. {description}")
    print(f"    å…¥åŠ›: '{test_input}'")
    print(f"    çµæœ: {d_logic_status}")
    print()

# æœ€çµ‚çµæœ
score_percentage = (perfect_score / total_tests) * 100
print("=" * 80)
print(f"ğŸ¯ æœ€çµ‚ã‚¹ã‚³ã‚¢: {perfect_score}/{total_tests} ({score_percentage:.1f}ç‚¹)")

if score_percentage == 100:
    print("ğŸ‰ 100ç‚¹æº€ç‚¹é”æˆï¼å®Œç’§ãªé«˜é€ŸåŒ–å®Ÿç¾ï¼")
    print("âœ¨ ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“: æŒ¨æ‹¶ãƒ»è³ªå• â†’ ç¬æ™‚å¿œç­”")
    print("ğŸ ç«¶é¦¬äºˆæƒ³: é¦¬åå…¥åŠ› â†’ é«˜é€ŸD-Logicåˆ†æ")
elif score_percentage >= 90:
    print("ğŸŠ å„ªç§€ï¼ã»ã¼å®Œç’§ãªé«˜é€ŸåŒ–ï¼")
else:
    print("âš ï¸ æ”¹å–„ãŒå¿…è¦ã§ã™")

print("=" * 80)